<button nz-button (click)="updateData()">refresh</button>
<br />
<br />

<nz-table
  class="datatable"
  #virtualTable
  nzVirtualScroll
  [nzVirtualItemSize]="40"
  [nzData]="listOfData"
  [nzFrontPagination]="false"
  [nzShowPagination]="true"
  [nzTotal]="1000000"
  [nzPageSize]="100"
  [nzPageIndex]="6"
  [nzScroll]="{ x: tableWidth + 'px', y: 'calc(100vh - 200px)' }"
  [nzLoading]="tableLoading"
>
  <thead [nzSingleSort]="true" (nzSortChange)="onSortChange($event)">
    <tr
      cdkDropList
      cdkDropListOrientation="horizontal"
      (cdkDropListDropped)="onColumnHeaderDrop($event)"
    >
      <th
        cdkDrag
        *ngFor="let column of tableColumns; trackBy: trackByKey"
        [nzWidth]="column.width + 'px'"
        [nzAlign]="column.align || 'center'"
        [nzShowSort]="column.sortable === 'custom'"
        [nzSortKey]="column.key"
      >
        {{ column.title }}
      </th>
    </tr>
  </thead>
  <tbody>
    <ng-template nz-virtual-scroll let-data let-index="index">
      <tr>
        <td
          *ngFor="let column of tableColumns; trackBy: trackByKey"
          [nzAlign]="column.align || 'center'"
          class="data-cell"
        >
          <div [style.width]="column.width - 16 + 'px'">
            <ng-container *ngIf="column.component; else elseTemplate">
              <ndc-dynamic
                [ndcDynamicComponent]="column.component"
                [ndcDynamicInputs]="{
                  cellValue: data[column.key],
                  index: index,
                  rowData: data,
                  columnOption: column
                }"
              ></ndc-dynamic>
            </ng-container>

            <ng-template #elseTemplate>
              {{ data[column.key] || "-" }}
            </ng-template>
          </div>
        </td>
      </tr>
    </ng-template>
  </tbody>
</nz-table>
